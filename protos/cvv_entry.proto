syntax = "proto3";

package metaApp;

enum CVVEntryResult {
    success        = 0;
    userCancelled  = 1;
    timeout        = 2;
}

message MagneticTrackData {
    repeated int32 data          = 1;
    int32 actualLen              = 2;
    repeated int32 ksn           = 3;
}

message MagneticStripeTracks {
    optional MagneticTrackData track1 = 1;
    optional MagneticTrackData track2 = 2;
    optional MagneticTrackData track3 = 3;
    optional string maskPan           = 4;
    optional string serviceCode       = 5;
}

message StartCVVEntryRequest {
    int32 allowedTries = 1;
    int32 timeout      = 2; // Timeout en segundos.
}

message FinishedCVVEntryResponse {
    CVVEntryResult cvvEntryResult                      = 1;
    optional MagneticStripeTracks magneticStripeTracks = 2;
    optional string enteredCVV                         = 3;
}